<div class="results-wrapper" fxLayout="column" fxLayoutAlign="space-between">
  <mat-toolbar color="primary">
    <span>Test Results</span>
  </mat-toolbar>
  <mat-card *ngIf="scan$ | async as scan" class="results-card">
    <mat-card-header>
      <mat-card-title>{{scan.tag}}</mat-card-title>
      <mat-card-subtitle>{{scan.timestamp | date:'MM/d/yyyy'}}</mat-card-subtitle>
    </mat-card-header>
    <div mat-card-image class="result-element" [ngClass]="[(scan.result != null && scan.result.label == 'positive') ? 'result-positive' : 'result-negative']" fxLayout="column">
      <h1 *ngIf="scan.result != null" class="result-text">{{scan.result.label}}</h1>
      <h1 *ngIf="scan.result == null" class="result-text">Pending Result</h1>
    </div>
    <mat-card-content>
      <p *ngIf="!scan.result" >Your results may take some time to process. Make sure that you look for and click on the notification alerting you that your results are available.</p>
      <div *ngIf="scan.result && scan.result.label == 'positive' && ackLoadingState$ | async as state">
        <p>Contact your doctor immediately.</p>
        <p>Please acknowlege your results to stop recieving notifications</p>
      </div>
      <div *ngIf="scan.result && scan.result.label == 'negative' && ackLoadingState$ | async as state">
        <p>You're good to go!</p>
        <p>Please acknowlege your results to stop recieving notifications</p>
      </div>
    </mat-card-content>
    <mat-card-actions *ngIf="ackLoadingState$ | async as state">
      <button mat-button (click)="exit()">OKAY</button>
      <button mat-raised-button color="primary" *ngIf="state == 'awaiting'" (click)="ack()" [disabled]="state == 'loading'">ACKNOWLEDGE</button>
    </mat-card-actions>
  </mat-card>
</div>
